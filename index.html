#include <iostream> 
#include <fstream> 
#include <windows.h> 
using namespace std;

struct Person
{
    string name;
    int first_mark;
    int second_mark;
    int third_mark;
    int forth_mark;
} A;

void main() {
    setlocale(LC_ALL, "rus");

    const char* nameA = "C:/Users/Admin/source/repos/ANSWER.bin";
    ofstream fR;
    ifstream fA;
    fstream fN;

    const char* nameN = "C:/Users/Admin/source/repos/REQUEST.bin";
    long pred_size;
    int answer;

    while (true)
    {
        cout << "Введите имя: ";
        cin >> A.name;
        cout << "Введите 4 оценки (каждая от 0 до 100):" << endl;

        cout << "Первая оценка: ";
        cin >> A.first_mark;
        cout << "Вторая оценка: ";
        cin >> A.second_mark;
        cout << "Третья оценка: ";
        cin >> A.third_mark;
        cout << "Четвертая оценка: ";
        cin >> A.forth_mark;

        // Проверка корректности введенных данных
        if (A.first_mark < 0 || A.first_mark > 100 ||
            A.second_mark < 0 || A.second_mark > 100 ||
            A.third_mark < 0 || A.third_mark > 100 ||
            A.forth_mark < 0 || A.forth_mark > 100) {
            cout << "Ошибка: все оценки должны быть в диапазоне от 0 до 100!" << endl;
            continue;
        }

        string s = "C:/Users/Admin/source/repos/" + A.name + ".bin";
        const char* nameR = s.c_str();

        fR.open(nameR, ios::app | ios::binary);
        fR.write((char*)&A, sizeof(A));
        fR.close();

        fN.open(nameN, ios::app | ios::binary);
        fN.write((char*)&A.name, sizeof(A.name));
        fN.close();

        fA.open(nameR, ios::binary);
        fA.seekg(0, ios::end);
        pred_size = fA.tellg();

        while (pred_size >= fA.tellg())
        {
            Sleep(100);
            fA.seekg(0, ios::end);
        }

        fA.seekg(pred_size, ios::beg);
        fA.read((char*)&answer, sizeof(answer));
        fA.close();

        cout << "Результат для студента " << A.name << ":" << endl;
        cout << "Сумма баллов: " << (A.first_mark + A.second_mark + A.third_mark + A.forth_mark) << endl;

        switch (answer) {
        case 2: { cout << "Оценка: 2 (неудовлетворительно)"; break; }
        case 3: { cout << "Оценка: 3 (удовлетворительно)"; break; }
        case 4: { cout << "Оценка: 4 (хорошо)"; break; }
        case 5: { cout << "Оценка: 5 (отлично)"; break; }
        default: { cout << "Ошибка вычисления оценки"; break; }
        }
        cout << endl << "------------------------" << endl;
    }
}


#include <iostream> 
#include <fstream> 
#include <windows.h> 
using namespace std;

struct Person
{
    string name;
    int first_mark;
    int second_mark;
    int third_mark;
    int forth_mark;
}B;

int answer;
long size_pred;
long size_pred_name;

int calculateGrade(int score) {
    if (score >= 0 && score <= 49) return 2;   // неудовлетворительно
    if (score >= 50 && score <= 74) return 3;  // удовлетворительно
    if (score >= 75 && score <= 89) return 4;  // хорошо
    if (score >= 90 && score <= 100) return 5; // отлично
    return 2; // по умолчанию неудовлетворительно
}

int main() {
    ifstream fR;
    ofstream fA;
    ifstream fN;
    setlocale(LC_ALL, "rus");

    const char* nameN = "C:/Users/Admin/source/repos/REQUEST.bin";
    const char* nameA = "C:/Users/Admin/source/repos/ANSWER.bin";

    fN.open(nameN, ios::binary);
    fN.seekg(0, ios::end);
    size_pred_name = fN.tellg();
    fN.close();

    cout << "Server is working" << endl;

    while (true)
    {
        fN.open(nameN, ios::binary);
        fN.seekg(0, ios::end);

        while (size_pred_name >= fN.tellg())
        {
            Sleep(100);
            fN.seekg(0, ios::end);
        }

        fN.seekg(size_pred_name, ios::beg);
        fN.read((char*)&B.name, sizeof(B.name));
        size_pred_name = fN.tellg();
        fN.close();

        string s = "C:/Users/Admin/source/repos/" + B.name + ".bin";
        const char* nameR = s.c_str();

        fR.open(nameR, ios::binary);
        fR.seekg(ios::beg, 0);
        fR.read((char*)&B, sizeof(B));

        // Рассчитываем общую сумму баллов
        int total_score = B.first_mark + B.second_mark + B.third_mark + B.forth_mark;

        // Определяем оценку по критериям
        answer = calculateGrade(total_score);

        fR.close();

        cout << "Сервер обработал данные студента " << B.name << endl;
        cout << "Баллы: " << B.first_mark << ", " << B.second_mark << ", "
            << B.third_mark << ", " << B.forth_mark << endl;
        cout << "Сумма баллов: " << total_score << ", Оценка: " << answer << endl;

        fA.open(nameR, ios::binary | ios::app);
        fA.write((char*)&answer, sizeof(answer));
        fA.close();
    }
}

#include <iostream> 
#include <fstream> 
#include <windows.h> 
#include <string>
using namespace std; 

struct Person 
{ 
    char name[100];  // Изменено на фиксированный массив char
    int first_mark; 
    int second_mark; 
    int third_mark; 
    int forth_mark; 
} A; 

int main() {  // main должен возвращать int
    setlocale(LC_ALL, "rus"); 
    
    const char* nameA = "ANSWER.bin"; 
    ofstream fR; 
    ifstream fA; 
    fstream fN; 
    
    const char* nameN = "REQUEST.bin"; 
    long pred_size; 
    int answer; 
    
    while (true) 
    { 
        cout << "Введите имя: "; 
        cin >> A.name; 
        cout << "Введите 4 оценки (каждая от 0 до 100):" << endl; 
        
        cout << "Первая оценка: ";
        cin >> A.first_mark;
        cout << "Вторая оценка: ";
        cin >> A.second_mark;
        cout << "Третья оценка: ";
        cin >> A.third_mark;
        cout << "Четвертая оценка: ";
        cin >> A.forth_mark;
        
        // Исправлено условие проверки
        if (A.first_mark < 0 || A.first_mark > 100 ||
            A.second_mark < 0 || A.second_mark > 100 ||
            A.third_mark < 0 || A.third_mark > 100 ||
            A.forth_mark < 0 || A.forth_mark > 100) {
            cout << "Ошибка: все оценки должны быть в диапазоне от 0 до 100!" << endl;
            continue;
        }
        
        string s = A.name + string(".bin"); 
        const char* nameR = s.c_str(); 
        
        fR.open(nameR, ios::binary); 
        fR.write((char*)&A, sizeof(A)); 
        fR.close(); 
        
        fN.open(nameN, ios::app | ios::binary); 
        fN.write(A.name, sizeof(A.name)); 
        fN.close(); 
        
        // Ожидание ответа от сервера
        fA.open(nameR, ios::binary); 
        fA.seekg(0, ios::end); 
        pred_size = fA.tellg(); 
        
        // Ждем пока файл не изменится
        while (pred_size >= fA.tellg()) 
        { 
            Sleep(100); 
            fA.seekg(0, ios::end); 
        } 
        
        // Читаем ответ с конца файла
        fA.seekg(-static_cast<int>(sizeof(answer)), ios::end);
        fA.read((char*)&answer, sizeof(answer)); 
        fA.close(); 
        
        cout << "Результат для студента " << A.name << ":" << endl;
        int total_score = A.first_mark + A.second_mark + A.third_mark + A.forth_mark;
        cout << "Сумма баллов: " << total_score << endl;
        
        switch (answer) { 
            case 2: {cout << "Оценка: 2 (неудовлетворительно)"; break; } 
            case 3: {cout << "Оценка: 3 (удовлетворительно)"; break; } 
            case 4: {cout << "Оценка: 4 (хорошо)"; break; } 
            case 5: {cout << "Оценка: 5 (отлично)"; break; } 
            default: {cout << "Ошибка вычисления оценки"; break; }
        } 
        cout << endl << "------------------------" << endl; 
    } 
    return 0;
}
    #include <iostream> 
#include <fstream> 
#include <windows.h> 
#include <string>
using namespace std; 

struct Person 
{ 
    char name[100];  // Изменено на фиксированный массив char
    int first_mark; 
    int second_mark; 
    int third_mark; 
    int forth_mark; 
} B; 

int answer; 
long size_pred_name; 

// Исправленная функция расчета оценки
int calculateGrade(int total_score) {
    if (total_score >= 0 && total_score <= 199) return 2;   // 0-49.75 средний балл
    if (total_score >= 200 && total_score <= 299) return 3; // 50-74.75 средний балл  
    if (total_score >= 300 && total_score <= 359) return 4; // 75-89.75 средний балл
    if (total_score >= 360 && total_score <= 400) return 5; // 90-100 средний балл
    return 2; // по умолчанию
}

int main() { 
    ifstream fR; 
    ofstream fA; 
    ifstream fN; 
    setlocale(LC_ALL, "rus"); 
    
    const char* nameN = "REQUEST.bin"; 
    const char* nameA = "ANSWER.bin"; 
    
    fN.open(nameN, ios::binary); 
    fN.seekg(0, ios::end); 
    size_pred_name = fN.tellg(); 
    fN.close(); 
    
    cout << "Server is working" << endl; 
    
    while (true) 
    { 
        fN.open(nameN, ios::binary); 
        fN.seekg(0, ios::end); 
        
        while (size_pred_name >= fN.tellg()) 
        { 
            Sleep(100); 
            fN.seekg(0, ios::end); 
        } 
        
        fN.seekg(size_pred_name, ios::beg); 
        fN.read((char*)&B.name, sizeof(B.name)); 
        size_pred_name = fN.tellg(); 
        fN.close(); 
        
        string s = string(B.name) + ".bin"; 
        const char* nameR = s.c_str(); 
        
        fR.open(nameR, ios::binary); 
        if (!fR.is_open()) {
            cout << "Ошибка открытия файла: " << nameR << endl;
            continue;
        }
        
        fR.read((char*)&B, sizeof(B)); 
        
        // Рассчитываем общую сумму баллов (0-400)
        int total_score = B.first_mark + B.second_mark + B.third_mark + B.forth_mark;
        
        // Определяем оценку по общей сумме
        answer = calculateGrade(total_score);
        
        fR.close(); 
        
        cout << "Сервер обработал данные студента " << B.name << endl;
        cout << "Баллы: " << B.first_mark << ", " << B.second_mark << ", " 
             << B.third_mark << ", " << B.forth_mark << endl;
        cout << "Сумма баллов: " << total_score << ", Оценка: " << answer << endl;
        
        // Записываем ответ в конец файла студента
        fA.open(nameR, ios::binary | ios::app); 
        fA.write((char*)&answer, sizeof(answer)); 
        fA.close(); 
    } 
    return 0;
}                                                    
